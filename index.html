<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LN4 - Premium Motion Portfolio</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Poppins:wght@100..900&display=swap" rel="stylesheet">
    
    <style>
        /*
        * Colors:
        * Background Gradient: #0d0d0f to #121212
        * Accent: #4f46e5 (Electric Indigo)
        * Text: #f5f5f7
        */

        body {
            background-color: #0d0d0f;
            font-family: 'Inter', sans-serif;
            color: #f5f5f7;
            overflow-x: hidden; /* Prevent horizontal scroll from GSAP animations */
            opacity: 0; /* Initially hidden to prevent FOUC */
            transition: opacity 0.5s ease;
        }
        body.ready {
            opacity: 1; /* Fade in when initialization is complete */
        }

        /* --- Animated Gradient Background --- */
        .moving-gradient {
            position: absolute;
            top: -200%;
            left: -200%;
            width: 400%;
            height: 400%;
            background: radial-gradient(circle at 15% 15%, rgba(18, 18, 18, 0.8) 0%, rgba(13, 13, 15, 0.9) 25%, rgba(18, 18, 18, 0) 50%);
            transition: transform 10s ease-in-out;
            z-index: -2; /* Behind everything */
            pointer-events: none;
            opacity: 0.8;
        }
        
        /* --- Custom Cursor --- */
        .custom-cursor {
            position: fixed;
            top: 0;
            left: 0;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: #4f46e5; /* Accent color */
            mix-blend-mode: difference;
            pointer-events: none;
            z-index: 9999;
            transition: width 0.3s, height 0.3s, opacity 0.3s, transform 0.1s ease-out;
            transform: translate(-50%, -50%);
            opacity: 0.5;
        }
        .custom-cursor.active {
            width: 48px;
            height: 48px;
            opacity: 0.8;
        }

        /* --- Scroll Animation Setup (GSAP Class) --- */
        .scroll-reveal {
            opacity: 0;
            transform-style: preserve-3d;
        }

        /* --- Horizontal Events Carousel Styling --- */
        .horizontal-wrap {
            height: 100vh;
            display: flex;
            align-items: center;
        }
        .horizontal-track {
            display: flex;
            flex-wrap: nowrap;
            padding-left: 10vw;
            will-change: transform;
        }
        .event-card {
            width: 60vw;
            height: 70vh;
            margin-right: 30px;
            flex-shrink: 0;
            border-radius: 1rem;
            overflow: hidden;
            position: relative;
            cursor: pointer;
        }
        @media (max-width: 768px) {
            .event-card {
                width: 85vw;
                height: 50vh;
            }
        }
        .event-overlay {
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .event-card:hover .event-overlay {
            opacity: 1;
        }

        /* --- Floating Particles (Simple CSS animation for subtle motion) --- */
        .particle {
            position: absolute;
            background: rgba(79, 70, 229, 0.4); /* Accent Glow */
            border-radius: 50%;
            pointer-events: none;
            animation: drift-glow 20s infinite alternate ease-in-out;
            filter: blur(2px);
            z-index: -1;
        }
        @keyframes drift-glow {
            0% { transform: translate(0, 0) scale(1); opacity: 0.3; }
            50% { transform: translate(15vw, 10vh) scale(1.1); opacity: 0.4; }
            100% { transform: translate(-10vw, -5vh) scale(0.9); opacity: 0.3; }
        }

    </style>
</head>
<body class="selection:bg-teal-300 selection:text-gray-900">

    <!-- Custom Cursor -->
    <div class="custom-cursor" id="customCursor"></div>

    <!-- Animated Gradient Background Layer -->
    <div id="movingGradient" class="moving-gradient opacity-50"></div>

    <!-- Floating Particles Layer -->
    <div id="particleContainer" class="absolute inset-0 overflow-hidden z-0">
        <!-- Particles will be generated by JavaScript for dynamic positioning -->
    </div>


    <!-- Header & Navigation -->
    <header class="sticky top-0 z-50 bg-gray-900/50 backdrop-blur-md">
        <nav class="container mx-auto px-4 lg:px-12 py-4 flex justify-between items-center h-20">
            <a href="#hero" id="logo" class="text-3xl font-black uppercase text-teal-400 tracking-widest transition duration-300 hover:text-white" data-cursor-target>LN4</a>
            <div class="space-x-8 text-lg font-medium hidden md:flex">
                <a href="#about" class="nav-link text-gray-300 hover:text-teal-400 transition duration-300" data-cursor-target>About Us</a>
                <a href="#events" class="nav-link text-gray-300 hover:text-teal-400 transition duration-300" data-cursor-target>Events</a>
                <a href="#gallery" class="nav-link text-gray-300 hover:text-teal-400 transition duration-300" data-cursor-target>Gallery</a>
                <a href="#team" class="nav-link text-gray-300 hover:text-teal-400 transition duration-300" data-cursor-target>Team</a>
            </div>
            <button class="md:hidden text-2xl" data-cursor-target>
                <!-- Icon from Lucide-React equivalent for mobile menu -->
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
            </button>
        </nav>
    </header>

    <main>
        <!-- 1. Hero Section -->
        <section id="hero" class="relative min-h-[90vh] flex items-center justify-center pt-24 pb-12 overflow-hidden">
            <div class="container mx-auto px-4 text-center z-10">
                <h1 id="heroTitle" class="text-6xl sm:text-7xl lg:text-9xl font-extrabold tracking-tighter uppercase text-white/95 leading-none mb-6">
                    MCLAREN<br>RACING
                </h1>
                <p id="heroTagline" class="text-xl sm:text-2xl font-light text-gray-400 tracking-wider max-w-2xl mx-auto">
                    The thrill of the race. The pursuit of perfection.
                    Dedicated to the legacy and the future of speed.
                </p>
            </div>
        </section>

        <!-- 2. About Us Section -->
        <section id="about" class="py-24 lg:py-40 bg-gray-900 overflow-hidden">
            <div class="container mx-auto px-4 lg:px-12">
                <div class="flex flex-col lg:flex-row gap-12 lg:gap-24 items-center">
                    
                    <!-- Left: Parallax Image -->
                    <div class="lg:w-1/2 w-full h-[50vh] relative overflow-hidden rounded-xl shadow-2xl shadow-indigo-900/20" data-parallax-target>
                        <img src="https://placehold.co/800x600/1e293b/4f46e5?text=LN4+Moment" 
                             alt="About us placeholder image" 
                             class="w-full h-full object-cover rounded-xl scale-[1.1] parallax-image"
                             onerror="this.onerror=null;this.src='https://placehold.co/800x600/1e293b/4f46e5?text=Image+Load+Error'">
                        <div class="absolute inset-0 bg-black/30"></div>
                    </div>

                    <!-- Right: Animated Text -->
                    <div id="aboutText" class="lg:w-1/2 w-full scroll-reveal">
                        <span class="text-base font-semibold uppercase text-teal-400 mb-2 block tracking-wider">Our Commitment</span>
                        <h2 class="text-4xl lg:text-6xl font-extrabold mb-8 leading-tight">
                            The Drive for Evolution.
                        </h2>
                        <p class="text-gray-300 mb-6 text-lg">
                            We don't just participate; we innovate. Inspired by the relentless pursuit of speed, our team pushes the boundaries of engineering and performance. Every lap, every strategy, and every detail is driven by a culture of continuous improvement.
                        </p>
                        <p class="text-gray-400 text-md">
                            From the pit wall to the finish line, our journey is defined by passion, precision, and an unyielding desire to deliver exceptional results for our fans and partners worldwide.
                        </p>
                        <a href="#" class="mt-8 inline-block px-8 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-full shadow-lg shadow-indigo-600/50 transition duration-300" data-cursor-target>
                            Read Full Story
                        </a>
                    </div>

                </div>
            </div>
        </section>
        
        <!-- 3. Events Section (Horizontal Pinned Scroll) -->
        <section id="events" class="pt-24 lg:pt-40 pb-24 lg:pb-40 bg-gray-900">
            <div class="container mx-auto px-4 lg:px-12 mb-16">
                <span class="text-base font-semibold uppercase text-teal-400 mb-2 block tracking-wider text-center">Calendar of Speed</span>
                <h2 class="text-4xl lg:text-6xl font-extrabold mb-8 leading-tight text-center">
                    Upcoming Global Events.
                </h2>
            </div>
            
            <div class="horizontal-scroll-container">
                <div class="horizontal-wrap">
                    <div id="horizontalTrack" class="horizontal-track">
                        <!-- Event Card 1 -->
                        <div class="event-card group z-20">
                            <img src="https://placehold.co/1200x800/18181b/ffffff?text=British+GP" 
                                 alt="British+GP" 
                                 class="w-full h-full object-cover transition duration-500 group-hover:scale-[1.02]"
                                 onerror="this.onerror=null;this.src='https://placehold.co/1200x800/18181b/ffffff?text=Image+Load+Error'">
                            <div class="event-overlay absolute inset-0 bg-gradient-to-t from-black/80 to-transparent flex items-end p-8">
                                <div class="text-white">
                                    <p class="text-2xl font-bold">Silverstone | British GP</p>
                                    <p class="text-teal-400 font-medium">July 18 - 20, 2025</p>
                                </div>
                            </div>
                        </div>

                        <!-- Event Card 2 -->
                        <div class="event-card group z-10" style="margin-top: 10vh; height: 60vh; width: 50vw;">
                            <img src="https://placehold.co/1000x700/0f0f0f/4f46e5?text=Monaco+GP" 
                                 alt="Monaco+GP" 
                                 class="w-full h-full object-cover transition duration-500 group-hover:scale-[1.02]"
                                 onerror="this.onerror=null;this.src='https://placehold.co/1000x700/0f0f0f/4f46e5?text=Image+Load+Error'">
                            <div class="event-overlay absolute inset-0 bg-gradient-to-t from-black/80 to-transparent flex items-end p-8">
                                <div class="text-white">
                                    <p class="text-2xl font-bold">Circuit de Monaco</p>
                                    <p class="text-teal-400 font-medium">May 23 - 25, 2025</p>
                                </div>
                            </div>
                        </div>

                        <!-- Event Card 3 -->
                        <div class="event-card group z-30" style="margin-top: -5vh; height: 80vh; width: 70vw;">
                            <img src="https://placehold.co/1500x900/18181b/ffffff?text=Singapore+Night+Race" 
                                 alt="Singapore+Night+Race" 
                                 class="w-full h-full object-cover transition duration-500 group-hover:scale-[1.02]"
                                 onerror="this.onerror=null;this.src='https://placehold.co/1500x900/18181b/ffffff?text=Image+Load+Error'">
                            <div class="event-overlay absolute inset-0 bg-gradient-to-t from-black/80 to-transparent flex items-end p-8">
                                <div class="text-white">
                                    <p class="text-2xl font-bold">Singapore GP (Night)</p>
                                    <p class="text-teal-400 font-medium">Sept 27 - 29, 2025</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Event Card 4 -->
                        <div class="event-card group z-10" style="width: 55vw;">
                            <img src="https://placehold.co/1100x600/0f0f0f/4f46e5?text=Brazil+GP" 
                                 alt="Brazil+GP" 
                                 class="w-full h-full object-cover transition duration-500 group-hover:scale-[1.02]"
                                 onerror="this.onerror=null;this.src='https://placehold.co/1100x600/0f0f0f/4f46e5?text=Image+Load+Error'">
                            <div class="event-overlay absolute inset-0 bg-gradient-to-t from-black/80 to-transparent flex items-end p-8">
                                <div class="text-white">
                                    <p class="text-2xl font-bold">Interlagos | Brazil</p>
                                    <p class="text-teal-400 font-medium">Nov 07 - 09, 2025</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="event-card mr-[20vw] bg-transparent opacity-0 pointer-events-none"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4. Gallery Section (Masonry Grid) -->
        <section id="gallery" class="py-24 lg:py-40 bg-gray-900 overflow-hidden">
            <div class="container mx-auto px-4 lg:px-12">
                <span class="text-base font-semibold uppercase text-teal-400 mb-2 block tracking-wider text-center">Visual Excellence</span>
                <h2 class="text-4xl lg:text-6xl font-extrabold mb-16 leading-tight text-center">
                    The Archive.
                </h2>

                <div class="grid grid-cols-2 md:grid-cols-3 gap-6 lg:gap-8">
                    <!-- Gallery Item 1 (Wide) -->
                    <div class="col-span-2 row-span-1 scroll-reveal">
                        <img src="https://placehold.co/1600x900/121212/4f46e5?text=Pit+Stop+Action" 
                             class="w-full h-full object-cover rounded-xl shadow-xl hover:scale-[1.01] transition duration-300 cursor-pointer" 
                             alt="Gallery Image 1" data-cursor-target
                             onerror="this.onerror=null;this.src='https://placehold.co/1600x900/121212/4f46e5?text=Image+Load+Error'">
                    </div>
                    <!-- Gallery Item 2 -->
                    <div class="col-span-1 row-span-2 scroll-reveal" style="transform-origin: top;">
                        <img src="https://placehold.co/800x1200/0d0d0f/4f46e5?text=Driver+Portrait" 
                             class="w-full h-full object-cover rounded-xl shadow-xl hover:scale-[1.01] transition duration-300 cursor-pointer" 
                             alt="Gallery Image 2" data-cursor-target
                             onerror="this.onerror=null;this.src='https://placehold.co/800x1200/0d0d0f/4f46e5?text=Image+Load+Error'">
                    </div>
                    <!-- Gallery Item 3 -->
                    <div class="col-span-1 row-span-1 scroll-reveal">
                        <img src="https://placehold.co/800x600/121212/4f46e5?text=Team+Celebrate" 
                             class="w-full h-full object-cover rounded-xl shadow-xl hover:scale-[1.01] transition duration-300 cursor-pointer" 
                             alt="Gallery Image 3" data-cursor-target
                             onerror="this.onerror=null;this.src='https://placehold.co/800x600/121212/4f46e5?text=Image+Load+Error'">
                    </div>
                    <!-- Gallery Item 4 -->
                    <div class="col-span-1 row-span-1 scroll-reveal">
                        <img src="https://placehold.co/800x600/0d0d0f/4f46e5?text=Car+Detail" 
                             class="w-full h-full object-cover rounded-xl shadow-xl hover:scale-[1.01] transition duration-300 cursor-pointer" 
                             alt="Gallery Image 4" data-cursor-target
                             onerror="this.onerror=null;this.src='https://placehold.co/800x600/0d0d0f/4f46e5?text=Image+Load+Error'">
                    </div>
                    <!-- Gallery Item 5 -->
                    <div class="col-span-1 row-span-1 scroll-reveal">
                        <img src="https://placehold.co/800x600/121212/4f46e5?text=Trophy" 
                             class="w-full h-full object-cover rounded-xl shadow-xl hover:scale-[1.01] transition duration-300 cursor-pointer" 
                             alt="Gallery Image 5" data-cursor-target
                             onerror="this.onerror=null;this.src='https://placehold.co/800x600/121212/4f46e5?text=Image+Load+Error'">
                    </div>
                    <!-- Gallery Item 6 (Tall) -->
                    <div class="col-span-1 row-span-2 scroll-reveal" style="transform-origin: top;">
                        <img src="https://placehold.co/800x1200/0d0d0f/4f46e5?text=Lando+Portrait" 
                             class="w-full h-full object-cover rounded-xl shadow-xl hover:scale-[1.01] transition duration-300 cursor-pointer" 
                             alt="Gallery Image 6" data-cursor-target
                             onerror="this.onerror=null;this.src='https://placehold.co/800x1200/0d0d0f/4f46e5?text=Image+Load+Error'">
                    </div>
                    <!-- Gallery Item 7 -->
                    <div class="col-span-1 row-span-1 scroll-reveal">
                        <img src="https://placehold.co/800x600/121212/4f46e5?text=Start+Grid" 
                             class="w-full h-full object-cover rounded-xl shadow-xl hover:scale-[1.01] transition duration-300 cursor-pointer" 
                             alt="Gallery Image 7" data-cursor-target
                             onerror="this.onerror=null;this.src='https://placehold.co/800x600/121212/4f46e5?text=Image+Load+Error'">
                    </div>
                </div>
            </div>
        </section>
        
        <!-- 5. Team Members Section -->
        <section id="team" class="py-24 lg:py-40 bg-gray-900 overflow-hidden">
            <div class="container mx-auto px-4 lg:px-12">
                <span class="text-base font-semibold uppercase text-teal-400 mb-2 block tracking-wider text-center">The Engine Room</span>
                <h2 class="text-4xl lg:text-6xl font-extrabold mb-16 leading-tight text-center">
                    Meet the Crew.
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    
                    <!-- Team Member 1 -->
                    <div class="group p-6 rounded-xl bg-[#1e293b]/50 hover:bg-[#1e293b]/80 border border-gray-700/50 shadow-2xl hover:shadow-indigo-500/30 transition duration-500 scroll-reveal" data-cursor-target>
                        <div class="w-24 h-24 mx-auto mb-4 rounded-full overflow-hidden border-4 border-indigo-500/50">
                            <img src="https://placehold.co/96x96/4f46e5/ffffff?text=Lando" alt="Team Member 1" class="w-full h-full object-cover">
                        </div>
                        <h3 class="text-2xl font-bold text-white text-center">Lando N.</h3>
                        <p class="text-teal-400 text-center font-medium mb-4">Lead Driver</p>
                        <p class="text-gray-400 text-center text-sm">The cornerstone of our team, combining precision driving with unmatched competitive fire.</p>
                    </div>

                    <!-- Team Member 2 -->
                    <div class="group p-6 rounded-xl bg-[#1e293b]/50 hover:bg-[#1e293b]/80 border border-gray-700/50 shadow-2xl hover:shadow-indigo-500/30 transition duration-500 scroll-reveal" data-cursor-target>
                        <div class="w-24 h-24 mx-auto mb-4 rounded-full overflow-hidden border-4 border-indigo-500/50">
                            <img src="https://placehold.co/96x96/4f46e5/ffffff?text=Carlos" alt="Team Member 2" class="w-full h-full object-cover">
                        </div>
                        <h3 class="text-2xl font-bold text-white text-center">Carlos S.</h3>
                        <p class="text-teal-400 text-center font-medium mb-4">Reserve Driver</p>
                        <p class="text-gray-400 text-center text-sm">A strategic mastermind on the track, providing crucial feedback and technical insight.</p>
                    </div>

                    <!-- Team Member 3 -->
                    <div class="group p-6 rounded-xl bg-[#1e293b]/50 hover:bg-[#1e293b]/80 border border-gray-700/50 shadow-2xl hover:shadow-indigo-500/30 transition duration-500 scroll-reveal" data-cursor-target>
                        <div class="w-24 h-24 mx-auto mb-4 rounded-full overflow-hidden border-4 border-indigo-500/50">
                            <img src="https://placehold.co/96x96/4f46e5/ffffff?text=Andrea" alt="Team Member 3" class="w-full h-full object-cover">
                        </div>
                        <h3 class="text-2xl font-bold text-white text-center">Andrea S.</h3>
                        <p class="text-teal-400 text-center font-medium mb-4">Team Principal</p>
                        <p class="text-gray-400 text-center text-sm">Guiding the entire operation with visionary leadership and an eye for future development.</p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-900/80 border-t border-gray-800 py-12">
        <div class="container mx-auto px-4 lg:px-12 text-center">
            <a href="#hero" class="text-2xl font-black uppercase text-teal-400 tracking-widest hover:text-white transition duration-300" data-cursor-target>LN4</a>
            <p class="mt-4 text-gray-500 text-sm">&copy; 2025 McLaren Racing Fan Site. All rights reserved.</p>
            <div class="mt-4 space-x-4 text-gray-400">
                <a href="#" class="hover:text-teal-400 transition duration-300" data-cursor-target>Twitter</a>
                <a href="#" class="hover:text-teal-400 transition duration-300" data-cursor-target>Instagram</a>
                <a href="#" class="hover:text-teal-400 transition duration-300" data-cursor-target>YouTube</a>
            </div>
        </div>
    </footer>

    <!-- Load necessary JavaScript Libraries at the end of the body for better performance and guaranteed loading order -->
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/SplitText.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@studio-freight/lenis@1.0.45/dist/lenis.min.js"></script>

    <script>
        // --- GLOBAL STATE FOR TIMEOUT FIX ---
        let startTime = Date.now();
        const MAX_WAIT_TIME = 3000; // 3 seconds to wait for CDNs to load


        // --- FUNCTION DEFINITIONS (Must be defined before they are called) ---

        const initSmoothScroll = () => {
            if (typeof Lenis === 'undefined') {
                console.error("Lenis is still undefined. Smooth scroll initialization skipped.");
                return;
            }

            const lenis = new Lenis({
                duration: 1.2,
                easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
                direction: 'vertical',
                gestureDirection: 'vertical',
                smooth: true,
                smoothTouch: false,
                touchMultiplier: 2,
            });

            lenis.on('scroll', (e) => {
                if (typeof ScrollTrigger !== 'undefined') {
                    ScrollTrigger.update(e);
                }
            });
            
            gsap.ticker.add((time) => {
                lenis.raf(time * 1000);
            });

            gsap.ticker.lagSmoothing(0);
            window.lenis = lenis; 
        };

        const initHeroAnimations = () => {
            const titleSplit = new SplitText("#heroTitle", { type: "lines, words" });
            const taglineSplit = new SplitText("#heroTagline", { type: "lines, words" });

            const tl = gsap.timeline({ defaults: { ease: "power3.out" } });

            tl.from("#logo", { duration: 1, opacity: 0, y: -50 }, 0.5)
              .from(".nav-link", { duration: 0.8, opacity: 0, y: -20, stagger: 0.1 }, "<")
              .from(titleSplit.words, {
                opacity: 0,
                y: 50,
                rotationX: -90,
                stagger: 0.04,
                duration: 1.2
            }, 0.8)
            .from(taglineSplit.words, {
                opacity: 0,
                y: 20,
                stagger: 0.02,
                duration: 0.8
            }, 1.2);
            
            gsap.to("#movingGradient", {
                x: '+=20%',
                y: '+=20%',
                rotation: '+=360',
                duration: 20,
                ease: "none",
                repeat: -1,
                yoyo: true
            });
        };
        
        const initCursor = () => {
            const cursor = document.getElementById('customCursor');
            const targets = document.querySelectorAll('[data-cursor-target]');

            let posX = 0;
            let posY = 0;
            let mouseX = 0;
            let mouseY = 0;

            gsap.ticker.add(() => {
                posX += (mouseX - posX) / 9;
                posY += (mouseY - posY) / 9;
                gsap.set(cursor, {
                    x: posX,
                    y: posY
                });
            });

            window.addEventListener('mousemove', (e) => {
                mouseX = e.clientX;
                mouseY = e.clientY;
            });

            targets.forEach(target => {
                target.addEventListener('mouseenter', () => cursor.classList.add('active'));
                target.addEventListener('mouseleave', () => cursor.classList.remove('active'));
            });
        };

        const initParticles = () => {
            const container = document.getElementById('particleContainer');
            const numParticles = 20;
            
            for (let i = 0; i < numParticles; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                const size = Math.random() * 7 + 3;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                particle.style.left = `${Math.random() * 100}vw`;
                particle.style.top = `${Math.random() * 100}vh`;

                particle.style.animationDelay = `-${Math.random() * 20}s`;

                container.appendChild(particle);
            }
        };

        const initScrollAnimations = () => {
            gsap.effects.scrollReveal("#aboutText", { start: "top 75%", y: 50, skewY: 0 });
            gsap.effects.scrollReveal("#gallery .scroll-reveal", { start: "top 85%", stagger: 0.05, duration: 0.8, y: 50, skewY: 0, rotationX: 0 });
            gsap.effects.scrollReveal("#team .scroll-reveal", { start: "top 80%", stagger: 0.15, duration: 1, y: 50, skewY: 0, rotationX: 0 });

            gsap.from(".parallax-image", {
                yPercent: -10, 
                ease: "none",
                scrollTrigger: {
                    trigger: "#about",
                    start: "top bottom",
                    end: "bottom top",
                    scrub: true,
                }
            });
        };

        const initHorizontalScroll = () => {
            const track = document.getElementById("horizontalTrack");
            const cards = gsap.utils.toArray(".event-card");
            
            if (window.innerWidth < 768) {
                cards.forEach(card => {
                    gsap.effects.scrollReveal(card, { start: "top 85%", y: 50, skewY: 0, rotationX: 0 });
                });
                return;
            }

            gsap.to(track, {
                x: () => - (track.scrollWidth - window.innerWidth * 0.9), 
                ease: "none",
                scrollTrigger: {
                    trigger: ".horizontal-scroll-container",
                    pin: true,
                    scrub: 1, 
                    start: "top top",
                    end: () => `+=${track.scrollWidth - window.innerWidth * 0.9}`, 
                    invalidateOnRefresh: true, 
                },
            });

            cards.forEach((card, i) => {
                gsap.to(card, {
                    y: i % 2 === 0 ? -50 : 50, 
                    ease: "none",
                    scrollTrigger: {
                        trigger: card,
                        containerAnimation: gsap.getTweenOf(track), 
                        start: "left right",
                        end: "right left",
                        scrub: 1,
                    },
                });
            });
        };

        // --- CORE INITIALIZATION ---

// --- CORE INITIALIZATION ---
function runInitialization() {
    // Register Plugins
    gsap.registerPlugin(SplitText, ScrollTrigger);

    // Initialize Lenis Smooth Scroll
    const lenis = new Lenis({
        duration: 1.2,
        easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
        smooth: true
    });
    function raf(time){ lenis.raf(time); requestAnimationFrame(raf); }
    requestAnimationFrame(raf);

    // ScrollTrigger uses Lenis's scroll position
    ScrollTrigger.scrollerProxy(document.body, {
        scrollTop(value) {
            if (arguments.length) {
                lenis.scrollTo(value);
            }
            return lenis.scroll;
        },
        getBoundingClientRect() {
            return { top: 0, left: 0, width: window.innerWidth, height: window.innerHeight };
        },
        pinType: document.body.style.transform ? "transform" : "fixed"
    });

    // --- Hero Animations ---
    const titleSplit = new SplitText("#heroTitle", { type: "lines, words" });
    const taglineSplit = new SplitText("#heroTagline", { type: "lines, words" });
    const tl = gsap.timeline({ defaults: { ease: "power3.out" } });
    tl.from("#logo", { duration: 1, opacity: 0, y: -50 }, 0.5)
      .from(".nav-link", { duration: 0.8, opacity: 0, y: -20, stagger: 0.1 }, "<")
      .from(titleSplit.words, { opacity: 0, y: 50, rotationX: -90, stagger: 0.04, duration: 1.2 }, 0.8)
      .from(taglineSplit.words, { opacity: 0, y: 20, stagger: 0.02, duration: 0.8 }, 1.2);

    // --- Gradient Animation ---
    gsap.to("#movingGradient", {
        x: '+=20%',
        y: '+=20%',
        rotation: '+=360',
        duration: 20,
        ease: "none",
        repeat: -1,
        yoyo: true
    });

    // --- Custom Cursor ---
    const cursor = document.getElementById('customCursor');
    const targets = document.querySelectorAll('[data-cursor-target]');
    let posX = 0, posY = 0, mouseX = 0, mouseY = 0;
    gsap.ticker.add(() => {
        posX += (mouseX - posX) / 9;
        posY += (mouseY - posY) / 9;
        gsap.set(cursor, { x: posX, y: posY });
    });
    window.addEventListener('mousemove', e => { mouseX = e.clientX; mouseY = e.clientY; });
    targets.forEach(target => {
        target.addEventListener('mouseenter', () => cursor.classList.add('active'));
        target.addEventListener('mouseleave', () => cursor.classList.remove('active'));
    });

    // --- Particles ---
    const container = document.getElementById('particleContainer');
    for (let i = 0; i < 20; i++) {
        const p = document.createElement('div');
        p.className = 'particle';
        const size = Math.random() * 7 + 3;
        p.style.width = `${size}px`;
        p.style.height = `${size}px`;
        p.style.left = `${Math.random() * 100}vw`;
        p.style.top = `${Math.random() * 100}vh`;
        p.style.animationDelay = `-${Math.random() * 20}s`;
        container.appendChild(p);
    }

    // --- Scroll Animations ---
    gsap.utils.toArray(".scroll-reveal").forEach(elem => {
        gsap.from(elem, {
            opacity: 0,
            y: 50,
            rotationX: -10,
            duration: 1,
            stagger: 0.1,
            scrollTrigger: {
                trigger: elem,
                scroller: document.body,
                start: "top 80%",
                toggleActions: "play none none reverse"
            }
        });
    });

    // --- About Parallax ---
    gsap.to(".parallax-image", {
        yPercent: -10,
        ease: "none",
        scrollTrigger: {
            trigger: "#about",
            scroller: document.body,
            start: "top bottom",
            end: "bottom top",
            scrub: true
        }
    });

    // --- Horizontal Scroll Events ---
    const track = document.getElementById("horizontalTrack");
    const totalScroll = track.scrollWidth - window.innerWidth;
    gsap.to(track, {
        x: -totalScroll,
        ease: "none",
        scrollTrigger: {
            trigger: ".horizontal-scroll-container",
            scroller: document.body,
            start: "top top",
            end: () => "+=" + totalScroll,
            scrub: 1,
            pin: true
        }
    });

    document.body.classList.add('ready');
    ScrollTrigger.addEventListener("refresh", () => lenis.update());
    ScrollTrigger.refresh();
}


        // Main Initialization Logic (Guaranteed to run when dependencies are ready OR after timeout)
        function initializeApp() {
            const elapsed = Date.now() - startTime;
            const dependenciesLoaded = typeof gsap !== 'undefined' && typeof ScrollTrigger !== 'undefined' && typeof SplitText !== 'undefined';
            
            if (dependenciesLoaded) {
                // Case 1: Dependencies loaded, run full initialization
                runInitialization();
                return;
            }
            
            if (elapsed > MAX_WAIT_TIME) {
                // Case 2: Timeout reached, run partial initialization (NO GSAP/Lenis)
                console.error("CRITICAL TIMEOUT: Dependencies did not load. Displaying content without motion features.");
                
                // Still initialize non-GSAP features and force display
                initCursor();
                initParticles();
                document.body.classList.add('ready');
                return;
            }

            // Case 3: Still waiting, check again on the next animation frame
            requestAnimationFrame(initializeApp);
        }

        // Start the continuous check
        requestAnimationFrame(initializeApp);
    </script>
</body>
</html>
